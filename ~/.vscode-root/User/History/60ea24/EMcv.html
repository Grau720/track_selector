<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Selector de g√©neros - Spotify</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 2em;
      background-color: #f4f4f4;
    }
    h1 {
      margin-bottom: 1em;
    }
    .generos {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      max-width: 800px;
    }
    .genero {
      background: white;
      padding: 10px;
      border-radius: 6px;
      box-shadow: 0 0 4px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
    }
    button {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 16px;
    }
    select {
      margin-top: 20px;
      padding: 8px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <h1>üéµ Selecciona los g√©neros musicales que quieres incluir</h1>
  <form id="generoForm">
    <div class="generos" id="generoContainer"></div>

    <h2>üéØ Selecciona la playlist de destino:</h2>
    <select id="playlistSelect"></select>

    <br>
    <button type="submit">Filtrar y a√±adir canciones</button>
  </form>

  <script>
    async function cargarGeneros() {
      const res = await fetch('/generos');
      const generos = await res.json();
      const cont = document.getElementById('generoContainer');
      generos.forEach(g => {
        const div = document.createElement('div');
        div.className = 'genero';
        div.innerHTML = `<label><input type="checkbox" name="genero" value="${g}"> ${g}</label>`;
        cont.appendChild(div);
      });
    }

    async function cargarPlaylists() {
      const res = await fetch('/playlists');
      const playlists = await res.json();
      const select = document.getElementById('playlistSelect');
      playlists.forEach(p => {
        const opt = document.createElement('option');
        opt.value = p.id;
        opt.textContent = `${p.name} (${p.tracks} tracks)`;
        select.appendChild(opt);
      });
    }

    document.getElementById('generoForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const generosSeleccionados = Array.from(document.querySelectorAll('input[name="genero"]:checked')).map(cb => cb.value);
      const playlistId = document.getElementById('playlistSelect').value;
      alert(`G√©neros seleccionados: ${generosSeleccionados.join(', ')}\nPlaylist destino: ${playlistId}`);
      // Aqu√≠ podr√≠as hacer una petici√≥n POST para procesar la acci√≥n
    });

    cargarGeneros();
    cargarPlaylists();
  </script>
</body>
</html>
